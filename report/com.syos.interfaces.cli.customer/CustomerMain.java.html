<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>CustomerMain.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">SYOS Coverage</a> &gt; <a href="index.source.html" class="el_package">com.syos.interfaces.cli.customer</a> &gt; <span class="el_source">CustomerMain.java</span></div><h1>CustomerMain.java</h1><pre class="source lang-java linenums">package com.syos.interfaces.cli.customer;

import com.syos.application.dto.AuthenticationDTO;
import com.syos.application.postprocessors.StockDeductionProcessor;
import com.syos.application.postprocessors.interfaces.BillPostProcessor;
import com.syos.data.dao.*;
import com.syos.data.dao.interfaces.*;
import com.syos.domain.entity.Customer;
import com.syos.domain.entity.TransactionType;
import com.syos.domain.notifications.StockEventPublisher;
import com.syos.domain.service.*;
import com.syos.domain.strategy.billing.OtcBillingStrategy;
import com.syos.domain.strategy.billing.WebBillingStrategy;
import com.syos.domain.strategy.billing.interfaces.BillingStrategy;
import com.syos.domain.strategy.stockselection.FEFOStockSelectionStrategy;
import com.syos.domain.strategy.stockselection.interfaces.StockSelectionStrategy;
import com.syos.utils.SessionManager;

import java.util.List;
import java.util.Map;
import java.util.Scanner;

<span class="nc" id="L23">public class CustomerMain {</span>

    public static void main(String[] args) {

<span class="nc" id="L27">        Map&lt;TransactionType, BillingStrategy&gt; strategyMap = Map.of(</span>
                TransactionType.OTC, new OtcBillingStrategy(),
                TransactionType.WEB, new WebBillingStrategy()
        );

<span class="nc" id="L32">        StockEventPublisher stockEventPublisher = new StockEventPublisher();</span>

<span class="nc" id="L34">        BillDao billDao = new BillDaoImpl();</span>
<span class="nc" id="L35">        BillItemDao billItemDao = new BillItemDaoImpl();</span>
<span class="nc" id="L36">        ProductDaoImpl productDao = new ProductDaoImpl();</span>
<span class="nc" id="L37">        CustomerDaoImpl customerDao = new CustomerDaoImpl();</span>
<span class="nc" id="L38">        EmployeeDaoImpl employeeDao = new EmployeeDaoImpl();</span>
<span class="nc" id="L39">        StockSelectionStrategy stockSelectionStrategy = new FEFOStockSelectionStrategy();</span>
<span class="nc" id="L40">        ShelfDao shelfDao = new ShelfDaoImpl();</span>
<span class="nc" id="L41">        StoreDao storeDao = new StoreDaoImpl();</span>
<span class="nc" id="L42">        WebInventoryDao webInventoryDao = new WebInventoryDaoImpl();</span>



<span class="nc" id="L46">        AuthenticationService authService = new AuthenticationService(customerDao,employeeDao);</span>
<span class="nc" id="L47">        CustomerAuthenticationCLI authCLI = new CustomerAuthenticationCLI(authService);</span>
<span class="nc" id="L48">        BillItemService billItemService = new BillItemService(productDao);</span>
<span class="nc" id="L49">        ProductService productService = new ProductService(productDao);</span>
<span class="nc" id="L50">        ShelfService shelfService = new ShelfService(shelfDao, storeDao, stockEventPublisher);</span>
<span class="nc" id="L51">        WebInventoryService webInventoryService = new WebInventoryService(webInventoryDao);</span>
<span class="nc" id="L52">        StockDeductionProcessor stockDeductionProcessor = new StockDeductionProcessor(webInventoryService, shelfService);</span>

<span class="nc" id="L54">        BillingService billingService = new BillingService(billDao, billItemDao, billItemService, customerDao, strategyMap, List.of(stockDeductionProcessor));</span>

<span class="nc" id="L56">        boolean authenticated = authCLI.start();</span>
<span class="nc bnc" id="L57" title="All 2 branches missed.">        if (!authenticated) {</span>
<span class="nc" id="L58">            System.out.println(&quot;Exiting the system. Please try again later.&quot;);</span>
<span class="nc" id="L59">            return;</span>
        }

<span class="nc" id="L62">        Customer customer = SessionManager.getInstance().getLoggedInCustomer();</span>
<span class="nc" id="L63">        String customerId = customer.getCustomerID();</span>
<span class="nc" id="L64">        Scanner scanner = new Scanner(System.in);</span>

        while (true) {
<span class="nc" id="L67">            System.out.println(&quot;\n=== SYOS Customer Menu ===&quot;);</span>
<span class="nc" id="L68">            System.out.println(&quot;1. Browse &amp; Buy Products&quot;);</span>
<span class="nc" id="L69">            System.out.println(&quot;2. View All Products&quot;);</span>
<span class="nc" id="L70">            System.out.println(&quot;3. View Bill by ID&quot;);</span>
<span class="nc" id="L71">            System.out.println(&quot;4. Logout&quot;);</span>
<span class="nc" id="L72">            System.out.print(&quot;Enter your option: &quot;);</span>

            int option;
<span class="nc bnc" id="L75" title="All 2 branches missed.">            while (!scanner.hasNextInt()) {</span>
<span class="nc" id="L76">                System.out.print(&quot;Please enter a valid number: &quot;);</span>
<span class="nc" id="L77">                scanner.next();</span>
            }
<span class="nc" id="L79">            option = scanner.nextInt();</span>
<span class="nc" id="L80">            scanner.nextLine();</span>

<span class="nc bnc" id="L82" title="All 4 branches missed.">            switch (option) {</span>
                case 1 -&gt; {
<span class="nc" id="L84">                    new CustomerPurchaseCLI(billingService, productService, webInventoryService).createWebBill(scanner);</span>
<span class="nc" id="L85">                }</span>
                case 2 -&gt; {
<span class="nc" id="L87">                    System.out.println(&quot;Feature not implemented yet.&quot;);</span>
//                    new PurchaseCLI(customerId).start();
<span class="nc" id="L89">                }</span>
                case 3 -&gt; {
<span class="nc" id="L91">                    System.out.println(&quot;Logged out successfully. Goodbye!&quot;);</span>
<span class="nc" id="L92">                    return;</span>
                }
<span class="nc" id="L94">                default -&gt; System.out.println(&quot;Invalid option. Please try again.&quot;);</span>
            }
<span class="nc" id="L96">        }</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.13.202504020838</span></div></body></html>